import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Moving from nxapi to Nexus.Client

## Function mapping

### addEventListener

Sets up a function that will be called whenever the specified eventName is triggered.

<Tabs>
<TabItem value="nxapi-addEventListener" label="nxapi">

```js
// OnActivate | OnBroadcast | OnCanChangeToContext | OnCanClose | OnChangeToContext | OnClose | OnDockingChanged | OnFocusChanged | OnThemeChanged
const eventName: string = 'OnThemeChanged';
const jsFunction: Function = (result: any) => { console.log('Theme changed', result); };
nxapi.addEventListener(eventName, jsFunction);
```

</TabItem>
<TabItem value="nexusClient-addEventListener" label="Nexus.Client">

```js
// OnActivate | OnBroadcast | OnCanChangeToContext | OnCanClose | OnChangeToContext | OnClose | OnDockingChanged | OnFocusChanged | OnThemeChanged
const eventName: string = 'OnThemeChanged';
const jsFunction: Function = (result: any) => { console.log('Theme changed', result); };
nexusClient.context.on(eventName, jsFunction);
```

</TabItem>
</Tabs>

### appSettings

Provides access to the appSettings section of the client configuration file.

<Tabs>
<TabItem value="nxapi-appSettings" label="nxapi">

```js
const name: string = 'RemoteAddress';
nxapi.appSettings(name);
```

</TabItem>
<TabItem value="nexusClient-appSettings" label="Nexus.Client">

```js
const name: string = 'RemoteAddress';
nexusClient.container.getConfiguration(name);
```

</TabItem>
</Tabs>

### broadcast

Broadcasts a message to all running nxapi js plugins (including the sender) that listen to the OnBroadcast event. The message structure is not predefinied.

<Tabs>
<TabItem value="nxapi-broadcast" label="nxapi">

```js
// TODO: Add example parameters
nxapi.broadcast(jsonString);
```

</TabItem>
<TabItem value="nexusClient-broadcast" label="Nexus.Client">

```js
// TODO: Add example parameters
nexusClient.io.broadcast(jsonString);
```

</TabItem>
</Tabs>

### changeToContext

Alters the NG container context. To do so, the following JSON string is passed as the first parameter to the changeToContext function.

<Tabs>
<TabItem value="nxapi-changeToContext" label="nxapi">

```js
// TODO: Add example parameters
nxapi.changeToContext(jsonString, preserve);
```

</TabItem>
<TabItem value="nexusClient-changeToContext" label="Nexus.Client">

```js
// TODO: Add example parameters
nexusClient.context.set(jsonString, preserve);
```

</TabItem>
</Tabs>

### close

Closes the plugin.

<Tabs>
<TabItem value="nxapi-close" label="nxapi">

```js
nxapi.close();
```

</TabItem>
<TabItem value="nexusClient-close" label="Nexus.Client">

```js
nexusClient.container.close();
```

</TabItem>
</Tabs>

### dispatch

Triggers a registered event (see also addEventListener()). This allows a previously registered event to be invoked manually.

<Tabs>
<TabItem value="nxapi-dispatch" label="nxapi">

```js
// TODO: Add example parameters
nxapi.dispatch(eventName, ...params);
```

</TabItem>
<TabItem value="nexusClient-dispatch" label="Nexus.Client">

```js
// TODO: Add example parameters
nexusClient.container.send(eventName, ...params);
```

</TabItem>
</Tabs>

### drag

Simulates dragging the plugin to a new location inside or outside the container.

<Tabs>
<TabItem value="nxapi-drag" label="nxapi">

```js
nxapi.drag();
```

</TabItem>
<TabItem value="nexusClient-drag" label="Nexus.Client">

```js
nexusClient.container.startDragging();
```

</TabItem>
</Tabs>

### executePlugin

<Tabs>
<TabItem value="nxapi-executePlugin" label="nxapi">

```js
// TODO: Add example parameters
nxapi.executePlugin(jsObject);
```

</TabItem>
<TabItem value="nexusClient-executePlugin" label="Nexus.Client">

```js
// TODO: Add example parameters
nexusClient.container.launch(jsObject);
```

</TabItem>
</Tabs>

### focus

Sets the visual focus on the plugin.

<Tabs>
<TabItem value="nxapi-focus" label="nxapi">

```js
nxapi.focus();
```

</TabItem>
<TabItem value="nexusClient-focus" label="Nexus.Client">

```js
nexusClient.container.focus();
```

</TabItem>
</Tabs>

### getConfiguration

Returns a JSON string representation of the plugin's XML configuration.

<Tabs>
<TabItem value="nxapi-getConfiguration" label="nxapi">

```js
const name: string = 'RemoteAddress';
nxapi.getConfiguration(name);
```

</TabItem>
<TabItem value="nexusClient-getConfiguration" label="Nexus.Client">

```js
const name: string = 'RemoteAddress';
nexusClient.container.getConfiguration(name);
```

</TabItem>
</Tabs>

### getContext

Returns a JSON string with the information about the current context.

<Tabs>
<TabItem value="nxapi-getContext" label="nxapi">

```js
nxapi.getContext();
```

</TabItem>
<TabItem value="nexusClient-getContext" label="Nexus.Client">

```js
nexusClient.context.get();
```

</TabItem>
</Tabs>

### getEventListeners

Returns an array with all registered event names.

<Tabs>
<TabItem value="nxapi-getEventListeners" label="nxapi">

```js
nxapi.getEventListeners();
```

</TabItem>
<TabItem value="nexusClient-getEventListeners" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>

### getMaximized

Returns a value indicating whether the plugin is maximized. To set the maximized state use the setMaximized() function.

| Value | Description |
| --- | --- |
| true | The plugin is maximized. The toolbar should display a maximize icon. |
| false | The plugin is restored. The toolbar should display a restore icon. |

<Tabs>
<TabItem value="nxapi-getMaximized" label="nxapi">

```js
nxapi.getMaximized();
```

</TabItem>
<TabItem value="nexusClient-getMaximized" label="Nexus.Client">

```js
nexusClient.container.isMaximized();
```

</TabItem>
</Tabs>

### getPinned

Returns a value indicating whether the plugin is pinned. To set the pinned state use the setPinned() function.

| Value | Description |
| --- | --- |
| true | The plugin is pinned. The toolbar should display a pin icon. |
| false | The plugin is not pinned. The toolbar should display an unpin icon |

<Tabs>
<TabItem value="nxapi-getPinned" label="nxapi">

```js
nxapi.getPinned();
```

</TabItem>
<TabItem value="nexusClient-getPinned" label="Nexus.Client">

```js
nexusClient.container.isPinned();
```

</TabItem>
</Tabs>

### getPluginInfo

Returns detailed information about the plugin the nxapi js runs in.

<Tabs>
<TabItem value="nxapi-getPluginInfo" label="nxapi">

```js
nxapi.getPluginInfo();
```

</TabItem>
<TabItem value="nexusClient-getPluginInfo" label="Nexus.Client">

```js
nexusClient.app.getInfo();
```

</TabItem>
</Tabs>

### getSessionId

Returns the session-identifier object of the currently logged-in user. To get the session id value the ID property must be accessed.

<Tabs>
<TabItem value="nxapi-getSessionId" label="nxapi">

```js
nxapi.getSessionId();
```

</TabItem>
<TabItem value="nexusClient-getSessionId" label="Nexus.Client">

```js
nexusClient.container.getSessionId();
```

</TabItem>
</Tabs>

### getUserId

Returns the user id of the currently logged-in user.

<Tabs>
<TabItem value="nxapi-getUserId" label="nxapi">

```js
nxapi.getUserId();
```

</TabItem>
<TabItem value="nexusClient-getUserId" label="Nexus.Client">

```js
nexusClient.context.getVariables(["UserId"]);
```

</TabItem>
</Tabs>

### getVariables

Returns the value of the context variables as a JSON string. Several variables can be queried in one function call.

<Tabs>
<TabItem value="nxapi-getVariables" label="nxapi">

```js
const variables: string[] = ["UserId", "RemoteAddress"];
nxapi.getVariables(variables);
```

</TabItem>
<TabItem value="nexusClient-getVariables" label="Nexus.Client">

```js
const variables: string[] = ["UserId", "RemoteAddress"];
nexusClient.context.getVariables(variables);
```

</TabItem>
</Tabs>

### isClosable

Returns true if the plugin is closeable.

<Tabs>
<TabItem value="nxapi-isClosable" label="nxapi">

```js
nxapi.isClosable();
```

</TabItem>
<TabItem value="nexusClient-isClosable" label="Nexus.Client">

```js
nexusClient.container.canClose();
```

</TabItem>
</Tabs>

### isDocked

Returns true if the plugin is docked.

<Tabs>
<TabItem value="nxapi-isDocked" label="nxapi">

```js
nxapi.isDocked();
```

</TabItem>
<TabItem value="nexusClient-isDocked" label="Nexus.Client">

```js
nexusClient.container.isDocked();
```

</TabItem>
</Tabs>

### isFocused

Returns true if the plugin has visual focus.

<Tabs>
<TabItem value="nxapi-isFocused" label="nxapi">

```js
nxapi.isFocused();
```

</TabItem>
<TabItem value="nexusClient-isFocused" label="Nexus.Client">

```js
nexusClient.container.hasFocus();
```

</TabItem>
</Tabs>

### publish

Publishes a typeName message on the NG container message bus. The message payload is passed as a JSON string as second parameter.
See typeAliases() function to get a shorter name for the message type.

<Tabs>
<TabItem value="nxapi-publish" label="nxapi">

```js
const typeName: string = "dataChangedMessage";
const jsonString: string = JSON.stringify({ Subject: 'Foo', Operation: 'Insert', Properties: [{ Key: 'Bar', Value: 'Bazz' }] });
nxapi.publish(typeName, jsonString);
```

</TabItem>
<TabItem value="nexusClient-publish" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>

### removeEventListener

Removes an event listener that was previously registered with addEventListener().

<Tabs>
<TabItem value="nxapi-removeEventListener" label="nxapi">

```js
const eventName: string = "OnThemeChanged";
nxapi.removeEventListener(eventName);
```

</TabItem>
<TabItem value="nexusClient-removeEventListener" label="Nexus.Client">

```js
const eventName: string = "OnThemeChanged";
nexusClient.context.off(eventName);
```

</TabItem>
</Tabs>

### setConfiguration

Writes the plugin's configuration to the database based on the JSON string representation.
The JSON string will be internally converted to XML. Attributes are prefixed with an @ and should be at the start of the object.

<Tabs>
<TabItem value="nxapi-setConfiguration" label="nxapi">

```js
const jsonString: string = JSON.stringify({ "configuration": { "setting": [{ "@id": "4711", "key": "Foo", "value": "Bar" }] } });
nxapi.setConfiguration(jsonString);
```

</TabItem>
<TabItem value="nexusClient-setConfiguration" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>

### setMaximized

Use the setMaximized() function to programmatically maximize and restore the plugin.

<Tabs>
<TabItem value="nxapi-setMaximized" label="nxapi">

```js
const maximized: boolean = true;
nxapi.setMaximized(maximized);
```

</TabItem>
<TabItem value="nexusClient-setMaximized" label="Nexus.Client">

```js
const maximized: boolean = true;
nexusClient.container.setMaximized(maximized);
```

</TabItem>
</Tabs>

### setPinned

Use the setPinned() function to programmatically pin and unpin the plugin.

<Tabs>
<TabItem value="nxapi-setPinned" label="nxapi">

```js
const pinned: boolean = true;
nxapi.setPinned(pinned);
```

</TabItem>
<TabItem value="nexusClient-setPinned" label="Nexus.Client">

```js
const pinned: boolean = true;
nexusClient.container.setPinned(pinned);
```

</TabItem>
</Tabs>

### subscribe

Subscribes to a typeName published to the NG container message bus. The jsFunction will be executed when the typeName event is received.
The function callback's parameter is a JSON string representation of an object of type typeName.

<Tabs>
<TabItem value="nxapi-subscribe" label="nxapi">

```js
const typeName: string = 'dataChangedMessage';
const jsFunction: function = (result: any) => { console.log(result); };
nxapi.subscribe(typeName, jsFunction);
```

</TabItem>
<TabItem value="nexusClient-subscribe" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>

### typeAliases

The typeAliases() function provides alias names for existing .NET types. An alias name can be useful for publish(), subscribe() and unsubscribe().

<Tabs>
<TabItem value="nxapi-typeAliases" label="nxapi">

```js
const jsObject: object = { dataChangedMessage: 'nexus.framework.windows.application.events.messages.datachangedmessage, nexus.framework.windows' };
nxapi.typeAliases(jsObject);
```

</TabItem>
<TabItem value="nexusClient-typeAliases" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>

### unsubscribe

Removes the current subscription of typeName from the NG container message bus.

<Tabs>
<TabItem value="nxapi-unsubscribe" label="nxapi">

```js
const typeName: string = 'dataChangedMessage';
nxapi.unsubscribe(typeName);
```

</TabItem>
<TabItem value="nexusClient-unsubscribe" label="Nexus.Client">

```js
// no longer supported
```

</TabItem>
</Tabs>
